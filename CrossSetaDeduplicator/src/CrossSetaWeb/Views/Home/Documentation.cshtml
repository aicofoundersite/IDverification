@{
    ViewData["Title"] = "Documentation";
}

<div class="container mt-4">
    <div class="row">
        <div class="col-md-3">
            <nav id="doc-nav" class="nav flex-column sticky-top" style="top: 80px;">
                <a class="nav-link text-success fw-bold" href="#core-requirements">Core Requirements</a>
                <a class="nav-link text-secondary" href="#bonus-features">Bonus Features</a>
                <a class="nav-link text-secondary" href="#architecture">Architecture</a>
                <a class="nav-link text-secondary" href="#verification-logic">Traffic Light Logic</a>
                <a class="nav-link text-secondary" href="#demo-data">Demo Data</a>
                <a class="nav-link text-secondary" href="#security">Security & Compliance</a>
                <a class="nav-link text-secondary" href="#reporting">Reporting</a>
            </nav>
        </div>
        
        <div class="col-md-9">
            <h1 class="display-4 mb-4 text-success border-bottom pb-2">Cross-SETA Deduplication System</h1>
            
            <section id="core-requirements" class="mb-5">
                <h2 class="text-primary"><i class="bi bi-check-circle-fill"></i> Core Requirements (Must-Haves)</h2>
                <div class="card mb-3 shadow-sm">
                    <div class="card-body">
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item">
                                <strong>Input Validation:</strong> Strict validation for South African ID numbers (Luhn Algorithm), Name, and Surname formats.
                            </li>
                            <li class="list-group-item">
                                <strong>Real-Time Verification:</strong> Instant connection to external data sources (Simulated Home Affairs) to verify identity.
                            </li>
                            <li class="list-group-item">
                                <strong>Audit Trail:</strong> Comprehensive logging of every single verification attempt, including user, timestamp, and result.
                            </li>
                        </ul>
                    </div>
                </div>
            </section>

            <section id="bonus-features" class="mb-5">
                <h2 class="text-info"><i class="bi bi-star-fill"></i> Bonus Points for Innovation</h2>
                <div class="card mb-3 shadow-sm">
                    <div class="card-body">
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item">
                                <strong>Offline Capability:</strong> Queueing and retry logic for verifications during system downtimes.
                            </li>
                            <li class="list-group-item">
                                <strong>User Experience (UX):</strong> Intuitive "Traffic Light" status badges (Green/Yellow/Red) for immediate visual feedback.
                            </li>
                            <li class="list-group-item">
                                <strong>Security:</strong> Full POPIA compliance with PII masking and secure data handling.
                            </li>
                        </ul>
                    </div>
                </div>
            </section>

            <section id="architecture" class="mb-5">
                <h2>1. Architecture Expectations</h2>
                <p>The system implements a modular <strong>N-Tier structure</strong> to ensure separation of concerns:</p>
                <ul>
                    <li><strong>Frontend (Presentation):</strong> ASP.NET Core MVC (C#) handling UI and user interaction.</li>
                    <li><strong>Logic (Business):</strong> VB.NET Class Library (`CrossSetaLogic`) encapsulating all validation and business rules.</li>
                    <li><strong>Data (Persistence):</strong> SQL Server accessed via ADO.NET/EF Core with parameterized queries.</li>
                </ul>
            </section>

            <section id="verification-logic" class="mb-5">
                <h2>2. Verification Logic: The "Traffic Light" Protocol</h2>
                <p>We apply the Interceptor Pattern to categorize verification results:</p>
                <div class="row text-center">
                    <div class="col-md-4">
                        <div class="card bg-success text-white mb-3">
                            <div class="card-body">
                                <h3>Green</h3>
                                <p><strong>Verified</strong></p>
                                <small>ID exists, Names match, Citizen is Alive.</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card bg-warning text-dark mb-3">
                            <div class="card-body">
                                <h3>Yellow</h3>
                                <p><strong>Review</strong></p>
                                <small>Surname Mismatch or minor discrepancy.</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card bg-danger text-white mb-3">
                            <div class="card-body">
                                <h3>Red</h3>
                                <p><strong>Invalid/Fraud</strong></p>
                                <small>ID Not Found, Deceased, or Invalid Format.</small>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="duplicate-checks" class="mb-5">
                <h2>3. Duplicate Learner Check Rules</h2>
                <p>A <strong>Pre-Registration Check</strong> is performed before committing any data to the local W&RSETA database. If a learner exists in another SETA's records, the registration is flagged.</p>
            </section>

            <section id="tech-stack" class="mb-5">
                <h2>4. Technology Options</h2>
                <p><strong>Language:</strong> VB.NET (Logic) & C# (Web) - Demonstrating interoperability.</p>
                <p><strong>Database:</strong> Microsoft SQL Server.</p>
            </section>

            <section id="demo-data" class="mb-5">
                <h2 class="text-primary border-bottom pb-2">Testing Scenarios & Demo IDs</h2>
                <p>Use these IDs to test the specific "Traffic Light" scenarios in the Bulk Registration or Single Registration forms.</p>
                
                <table class="table table-bordered table-hover">
                    <thead class="table-dark">
                        <tr>
                            <th>Scenario</th>
                            <th>Status</th>
                            <th>National ID</th>
                            <th>Surname Input</th>
                            <th>Expected Result</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Valid Citizen</strong></td>
                            <td><span class="badge bg-success">Green</span></td>
                            <td><code>0002080806082</code></td>
                            <td><code>Makaula</code></td>
                            <td>Verification Successful.</td>
                        </tr>
                        <tr>
                            <td><strong>Surname Mismatch</strong></td>
                            <td><span class="badge bg-warning text-dark">Yellow</span></td>
                            <td><code>0002080806082</code></td>
                            <td><code>Smith</code></td>
                            <td>Flagged for Review (Surname does not match Home Affairs).</td>
                        </tr>
                        <tr>
                            <td><strong>Deceased Citizen</strong></td>
                            <td><span class="badge bg-danger">Red</span></td>
                            <td><code>0001010000001</code></td>
                            <td><em>Any</em></td>
                            <td>Blocked. Citizen marked as Deceased.</td>
                        </tr>
                        <tr>
                            <td><strong>ID Not Found</strong></td>
                            <td><span class="badge bg-danger">Red</span></td>
                            <td><code>9999999999999</code></td>
                            <td><em>Any</em></td>
                            <td>Blocked. Identity Number not found in source.</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <section id="security" class="mb-5">
                <h2>8. Security & Compliance</h2>
                <ul>
                    <li><strong>POPIA Compliance:</strong> PII is masked in admin views.</li>
                    <li><strong>Secure Config:</strong> No hardcoded API keys; credentials managed via Environment Variables.</li>
                    <li><strong>Input Sanitization:</strong> All inputs sanitized to prevent SQL Injection and XSS.</li>
                </ul>
            </section>

            <section id="reporting" class="mb-5">
                <h2>9. Reporting Requirements</h2>
                <p>The <strong>Administrative Dashboard</strong> visualizes:</p>
                <ul>
                    <li>Total Verifications vs. Failures.</li>
                    <li>Exportable lists of "Blocked" or "Flagged" attempts for audit purposes.</li>
                </ul>
            </section>
        </div>
    </div>
</div>
